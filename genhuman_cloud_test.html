<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenHuman API Èõ≤Á´ØÊ∏¨Ë©¶‰∏≠ÂøÉ</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            max-width: 1600px; 
            margin: 0 auto; 
            padding: 20px; 
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
        }
        .header {
            background: rgba(255,255,255,0.95);
            color: #2c3e50;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(480px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        .test-section { 
            background: rgba(255,255,255,0.95);
            padding: 30px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .test-section:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }
        .test-section h3 { 
            color: #2c3e50; 
            margin-top: 0; 
            border-bottom: 4px solid #6a11cb;
            padding-bottom: 15px;
            font-size: 1.4em;
        }
        .form-group { 
            margin: 20px 0; 
        }
        .form-group label { 
            display: block; 
            margin-bottom: 10px; 
            font-weight: 600;
            color: #34495e;
            font-size: 1.1em;
        }
        .form-group input, .form-group textarea, .form-group select { 
            width: 100%; 
            padding: 15px; 
            border: 3px solid #e1e8ed; 
            border-radius: 10px; 
            font-size: 15px;
            transition: all 0.3s ease;
        }
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            border-color: #6a11cb;
            outline: none;
            box-shadow: 0 0 0 4px rgba(106, 17, 203, 0.1);
        }
        .btn { 
            padding: 15px 30px; 
            background: linear-gradient(135deg, #6a11cb, #2575fc); 
            color: white; 
            border: none; 
            border-radius: 10px; 
            cursor: pointer; 
            margin: 10px 8px; 
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.3);
        }
        .btn:hover { 
            background: linear-gradient(135deg, #2575fc, #6a11cb); 
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(106, 17, 203, 0.4);
        }
        .btn:disabled { 
            background: #bdc3c7; 
            cursor: not-allowed; 
            transform: none;
            box-shadow: none;
        }
        .btn-success { 
            background: linear-gradient(135deg, #00b894, #00cec9); 
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3);
        }
        .btn-success:hover { 
            background: linear-gradient(135deg, #00cec9, #74b9ff); 
        }
        .btn-warning { 
            background: linear-gradient(135deg, #fdcb6e, #e17055); 
            box-shadow: 0 5px 15px rgba(253, 203, 110, 0.3);
        }
        .btn-warning:hover { 
            background: linear-gradient(135deg, #e17055, #d63031); 
        }
        .btn-danger { 
            background: linear-gradient(135deg, #e84393, #fd79a8); 
            box-shadow: 0 5px 15px rgba(232, 67, 147, 0.3);
        }
        .btn-danger:hover { 
            background: linear-gradient(135deg, #fd79a8, #fdcb6e); 
        }
        
        .result { 
            margin-top: 25px; 
            padding: 20px; 
            border-radius: 12px; 
            white-space: pre-wrap; 
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border: 3px solid;
        }
        .success { 
            background: rgba(212, 244, 230, 0.9); 
            border-color: #00b894; 
            color: #00875f; 
        }
        .error { 
            background: rgba(255, 235, 238, 0.9); 
            border-color: #e84393; 
            color: #c44569; 
        }
        .log { 
            background: rgba(248, 249, 250, 0.9); 
            border-color: #dee2e6; 
            color: #495057; 
            max-height: 350px; 
            overflow-y: auto;
        }
        
        .stats-panel {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        .stat-item {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 28px;
            font-weight: bold;
            color: #6a11cb;
        }
        .stat-label {
            font-size: 15px;
            color: #7f8c8d;
            margin-top: 8px;
        }
        
        .progress-bar {
            width: 100%;
            height: 25px;
            background: #ecf0f1;
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            transition: width 0.5s ease;
        }
        
        .status-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 10px;
        }
        .status-healthy { background: #00b894; }
        .status-error { background: #e84393; }
        .status-processing { 
            background: #fdcb6e; 
            animation: genhuman-pulse 2s infinite; 
        }
        
        @keyframes genhuman-pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .genhuman-logo {
            font-size: 3em;
            color: #6a11cb;
            margin-bottom: 15px;
        }
        
        .api-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 5px solid #6a11cb;
            font-family: 'Courier New', monospace;
        }
        
        .task-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin: 5px;
        }
        .status-pending { background: #ddd; color: #666; }
        .status-processing { background: #fff3cd; color: #856404; }
        .status-completed { background: #d4edda; color: #155724; }
        .status-failed { background: #f8d7da; color: #721c24; }
        
        .callback-panel {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }
        
        .file-upload-area {
            border: 3px dashed #6a11cb;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            margin: 15px 0;
        }
        .file-upload-area:hover {
            border-color: #2575fc;
            background: rgba(106, 17, 203, 0.05);
        }
        .file-upload-area.dragover {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.1);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="genhuman-logo">ü§ñ</div>
        <h1>GenHuman API Èõ≤Á´ØÊ∏¨Ë©¶‰∏≠ÂøÉ</h1>
        <p>Âü∫ÊñºÂâçÁ´ØÊàêÂäüÁ∂ìÈ©ó | ÂÆåÊï¥APIÊ∏¨Ë©¶ | MySQLÊï∏ÊìöÊåÅ‰πÖÂåñ</p>
        <div>
            <span class="status-indicator" id="genhumanStatus"></span>
            <span id="genhumanStatusText">Ê≠£Âú®Ê™¢Êü•GenHuman APIÁãÄÊÖã...</span>
        </div>
    </div>

    <!-- GenHumanÊ∏¨Ë©¶Áµ±Ë®àÈù¢Êùø -->
    <div class="stats-panel">
        <h3>üìä GenHuman API Ê∏¨Ë©¶Áµ±Ë®à</h3>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-number" id="genhumanTotalCalls">0</div>
                <div class="stat-label">Á∏ΩAPIË™øÁî®</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="genhumanSuccessCalls">0</div>
                <div class="stat-label">ÊàêÂäüË™øÁî®</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="genhumanProcessingTasks">0</div>
                <div class="stat-label">ËôïÁêÜ‰∏≠‰ªªÂãô</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="genhumanCompletedTasks">0</div>
                <div class="stat-label">ÂÆåÊàê‰ªªÂãô</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="genhumanAvgTime">0s</div>
                <div class="stat-label">Âπ≥ÂùáÈüøÊáâÊôÇÈñì</div>
            </div>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="genhumanSuccessRate" style="width: 0%"></div>
        </div>
        <div style="text-align: center; margin-top: 12px; font-size: 16px;">
            APIÊàêÂäüÁéá: <span id="genhumanSuccessRateText">0%</span>
        </div>
    </div>

    <!-- GenHuman APIÊ∏¨Ë©¶ÂäüËÉΩÁ∂≤Ê†º -->
    <div class="test-grid">
        <!-- ËÅ≤Èü≥ÂÖãÈöÜÊ∏¨Ë©¶ -->
        <div class="test-section">
            <h3>üé§ ËÅ≤Èü≥ÂÖãÈöÜ API Ê∏¨Ë©¶</h3>
            
            <div class="form-group">
                <label>ËÅ≤Èü≥ÂêçÁ®±Ôºö</label>
                <input type="text" id="voiceName" placeholder="‰æãÂ¶ÇÔºöÊàëÁöÑÂ∞àÂ±¨ËÅ≤Èü≥" value="Ê∏¨Ë©¶ËÅ≤Èü≥_Èõ≤Á´Ø">
            </div>
            
            <div class="file-upload-area" id="voiceUploadArea">
                <p>üì§ ÊãñÊîæÈü≥È†ªÊñá‰ª∂Âà∞ÈÄôË£°ÊàñÈªûÊìäÈÅ∏Êìá</p>
                <input type="file" id="voiceAudioFile" accept="audio/*" style="display:none;">
                <button class="btn" onclick="document.getElementById('voiceAudioFile').click()">ÈÅ∏ÊìáÈü≥È†ªÊñá‰ª∂</button>
            </div>
            
            <div class="form-group">
                <label>ÊàñËÄÖËº∏ÂÖ•Èü≥È†ªURLÔºö</label>
                <input type="url" id="voiceAudioUrl" placeholder="https://example.com/audio.mp3">
            </div>
            
            <div class="form-group">
                <label>Ë™ûË®ÄË®≠ÁΩÆÔºö</label>
                <select id="voiceLanguage">
                    <option value="zh">‰∏≠Êñá</option>
                    <option value="en">English</option>
                    <option value="ja">Êó•Êú¨Ë™û</option>
                    <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Èü≥È†ªË≥™ÈáèÔºö</label>
                <select id="voiceQuality">
                    <option value="high">È´òË≥™Èáè</option>
                    <option value="medium">‰∏≠Á≠âË≥™Èáè</option>
                    <option value="low">‰ΩéË≥™Èáè</option>
                </select>
            </div>
            
            <div class="api-info">
                APIÁ´ØÈªû: POST /api/v1/voice_clone<br>
                ÂõûË™øÂú∞ÂùÄ: https://vidsparkback.zeabur.app/api/genhuman/voice-clone/callback
            </div>
            
            <button class="btn" onclick="testVoiceClone()">üéµ ÈñãÂßãËÅ≤Èü≥ÂÖãÈöÜ</button>
            <button class="btn btn-success" onclick="checkVoiceCloneStatus()">üìä Ê™¢Êü•ÂÖãÈöÜÁãÄÊÖã</button>
            <button class="btn btn-warning" onclick="listVoiceClones()">üìã ÂÖãÈöÜÊ≠∑Âè≤</button>
            
            <div id="voiceCloneResult" class="result"></div>
            <div id="voiceCloneLog" class="result log"></div>
        </div>

        <!-- Êï∏Â≠ó‰∫∫ÂÖãÈöÜÊ∏¨Ë©¶ -->
        <div class="test-section">
            <h3>üë§ Êï∏Â≠ó‰∫∫ÂÖãÈöÜ API Ê∏¨Ë©¶</h3>
            
            <div class="form-group">
                <label>ËßíËâ≤ÂêçÁ®±Ôºö</label>
                <input type="text" id="characterName" placeholder="‰æãÂ¶ÇÔºöÊàëÁöÑÊï∏Â≠óÂàÜË∫´" value="Ê∏¨Ë©¶Êï∏Â≠ó‰∫∫_Èõ≤Á´Ø">
            </div>
            
            <div class="file-upload-area" id="imageUploadArea">
                <p>üì§ ÊãñÊîæÂúñÁâáÊñá‰ª∂Âà∞ÈÄôË£°ÊàñÈªûÊìäÈÅ∏Êìá</p>
                <input type="file" id="characterImageFile" accept="image/*" style="display:none;">
                <button class="btn" onclick="document.getElementById('characterImageFile').click()">ÈÅ∏ÊìáÂúñÁâáÊñá‰ª∂</button>
            </div>
            
            <div class="form-group">
                <label>ÊàñËÄÖËº∏ÂÖ•ÂúñÁâáURLÔºö</label>
                <input type="url" id="characterImageUrl" placeholder="https://example.com/image.jpg">
            </div>
            
            <div class="form-group">
                <label>Êï∏Â≠ó‰∫∫È°ûÂûãÔºö</label>
                <select id="characterType">
                    <option value="realistic">ÁúüÂØ¶‰∫∫Áâ©</option>
                    <option value="cartoon">Âç°ÈÄöÈ¢®Ê†º</option>
                    <option value="anime">ÂãïÊº´È¢®Ê†º</option>
                    <option value="custom">Ëá™ÂÆöÁæ©È¢®Ê†º</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ë°®ÊÉÖË®≠ÁΩÆÔºö</label>
                <select id="characterExpression">
                    <option value="neutral">‰∏≠ÊÄßË°®ÊÉÖ</option>
                    <option value="smile">ÂæÆÁ¨ë</option>
                    <option value="serious">Âö¥ËÇÖ</option>
                    <option value="friendly">ÂèãÂ•Ω</option>
                </select>
            </div>
            
            <div class="api-info">
                APIÁ´ØÈªû: POST /api/v1/digital_human_clone<br>
                ÂõûË™øÂú∞ÂùÄ: https://vidsparkback.zeabur.app/api/genhuman/digital-human/callback
            </div>
            
            <button class="btn" onclick="testDigitalHumanClone()">üë®‚Äçüíº ÈñãÂßãÊï∏Â≠ó‰∫∫ÂÖãÈöÜ</button>
            <button class="btn btn-success" onclick="checkDigitalHumanStatus()">üìä Ê™¢Êü•ÂÖãÈöÜÁãÄÊÖã</button>
            <button class="btn btn-warning" onclick="listDigitalHumans()">üìã ÂÖãÈöÜÊ≠∑Âè≤</button>
            
            <div id="digitalHumanResult" class="result"></div>
            <div id="digitalHumanLog" class="result log"></div>
        </div>

        <!-- Ë™ûÈü≥ÂêàÊàêÊ∏¨Ë©¶ -->
        <div class="test-section">
            <h3>üîä Ë™ûÈü≥ÂêàÊàê API Ê∏¨Ë©¶</h3>
            
            <div class="form-group">
                <label>ÂêàÊàêÊñáÊú¨Ôºö</label>
                <textarea id="synthesisText" rows="4" placeholder="Ëº∏ÂÖ•Ë¶ÅÂêàÊàêË™ûÈü≥ÁöÑÊñáÊú¨ÂÖßÂÆπ...">Ê≠°Ëøé‰ΩøÁî®GenHuman APIÈõ≤Á´ØÊ∏¨Ë©¶‰∏≠ÂøÉÔºåÈÄôÊòØ‰∏ÄÂÄãÂÆåÊï¥ÁöÑË™ûÈü≥ÂêàÊàêÊ∏¨Ë©¶„ÄÇ</textarea>
            </div>
            
            <div class="form-group">
                <label>ÈÅ∏ÊìáÂÖãÈöÜÁöÑËÅ≤Èü≥Ôºö</label>
                <select id="synthesisVoiceId">
                    <option value="">Ë´ãÂÖàÂÆåÊàêËÅ≤Èü≥ÂÖãÈöÜ</option>
                </select>
                <button class="btn btn-warning" onclick="loadAvailableVoices()">üîÑ Âà∑Êñ∞ËÅ≤Èü≥ÂàóË°®</button>
            </div>
            
            <div class="form-group">
                <label>Ë™ûÈÄüË®≠ÁΩÆÔºö</label>
                <select id="synthesisSpeed">
                    <option value="slow">ÊÖ¢ÈÄü (0.8x)</option>
                    <option value="normal">Ê≠£Â∏∏ (1.0x)</option>
                    <option value="fast">Âø´ÈÄü (1.2x)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Èü≥Ë™øË®≠ÁΩÆÔºö</label>
                <select id="synthesisPitch">
                    <option value="low">‰ΩéÈü≥Ë™ø</option>
                    <option value="normal">Ê≠£Â∏∏Èü≥Ë™ø</option>
                    <option value="high">È´òÈü≥Ë™ø</option>
                </select>
            </div>
            
            <div class="api-info">
                APIÁ´ØÈªû: POST /api/v1/text_to_speech<br>
                ÂõûË™øÂú∞ÂùÄ: https://vidsparkback.zeabur.app/api/genhuman/tts/callback
            </div>
            
            <button class="btn" onclick="testTextToSpeech()">üîä ÈñãÂßãË™ûÈü≥ÂêàÊàê</button>
            <button class="btn btn-success" onclick="checkTTSStatus()">üìä Ê™¢Êü•ÂêàÊàêÁãÄÊÖã</button>
            <button class="btn btn-warning" onclick="listTTSHistory()">üìã ÂêàÊàêÊ≠∑Âè≤</button>
            
            <div id="ttsResult" class="result"></div>
            <div id="ttsLog" class="result log"></div>
        </div>

        <!-- Êï∏Â≠ó‰∫∫Ë¶ñÈ†ªÁîüÊàêÊ∏¨Ë©¶ -->
        <div class="test-section">
            <h3>üé¨ Êï∏Â≠ó‰∫∫Ë¶ñÈ†ªÁîüÊàêÊ∏¨Ë©¶</h3>
            
            <div class="form-group">
                <label>Ë¶ñÈ†ªËÖ≥Êú¨Ôºö</label>
                <textarea id="videoScript" rows="4" placeholder="Ëº∏ÂÖ•Êï∏Â≠ó‰∫∫Ë¶ÅË™™ÁöÑÂÖßÂÆπ...">Â§ßÂÆ∂Â•ΩÔºåÊàëÊòØÈÄöÈÅéGenHuman APIÂâµÂª∫ÁöÑÊï∏Â≠ó‰∫∫„ÄÇÈÄôÊòØ‰∏ÄÂÄãÂÆåÊï¥ÁöÑË¶ñÈ†ªÁîüÊàêÊ∏¨Ë©¶ÔºåÂ±ïÁ§∫‰∫ÜÂæûÊñáÊú¨Âà∞Ë¶ñÈ†ªÁöÑÂÆåÊï¥ÊµÅÁ®ã„ÄÇ</textarea>
            </div>
            
            <div class="form-group">
                <label>ÈÅ∏ÊìáÊï∏Â≠ó‰∫∫Ôºö</label>
                <select id="videoDigitalHumanId">
                    <option value="">Ë´ãÂÖàÂÆåÊàêÊï∏Â≠ó‰∫∫ÂÖãÈöÜ</option>
                </select>
                <button class="btn btn-warning" onclick="loadAvailableDigitalHumans()">üîÑ Âà∑Êñ∞Êï∏Â≠ó‰∫∫ÂàóË°®</button>
            </div>
            
            <div class="form-group">
                <label>ÈÅ∏ÊìáËÅ≤Èü≥Ôºö</label>
                <select id="videoVoiceId">
                    <option value="">ÈÅ∏ÊìáËÅ≤Èü≥ÔºàÂèØÈÅ∏Ôºâ</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ë¶ñÈ†ªÂàÜËæ®ÁéáÔºö</label>
                <select id="videoResolution">
                    <option value="720p">720p (1280x720)</option>
                    <option value="1080p">1080p (1920x1080)</option>
                    <option value="4k">4K (3840x2160)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>ËÉåÊôØË®≠ÁΩÆÔºö</label>
                <select id="videoBackground">
                    <option value="default">ÈªòË™çËÉåÊôØ</option>
                    <option value="office">Ëæ¶ÂÖ¨ÂÆ§</option>
                    <option value="studio">ÊºîÊí≠Âª≥</option>
                    <option value="custom">Ëá™ÂÆöÁæ©</option>
                </select>
            </div>
            
            <div class="api-info">
                APIÁ´ØÈªû: POST /api/v1/digital_human_video<br>
                ÂõûË™øÂú∞ÂùÄ: https://vidsparkback.zeabur.app/api/genhuman/video/callback
            </div>
            
            <button class="btn" onclick="testDigitalHumanVideo()">üé¨ ÈñãÂßãË¶ñÈ†ªÁîüÊàê</button>
            <button class="btn btn-success" onclick="checkVideoStatus()">üìä Ê™¢Êü•ÁîüÊàêÁãÄÊÖã</button>
            <button class="btn btn-warning" onclick="listVideoHistory()">üìã ÁîüÊàêÊ≠∑Âè≤</button>
            
            <div id="videoGenerationResult" class="result"></div>
            <div id="videoGenerationLog" class="result log"></div>
        </div>

        <!-- ÂõûË™øÁãÄÊÖãÁõ£ÊéßÈù¢Êùø -->
        <div class="test-section">
            <h3>üìû ÂõûË™øÁãÄÊÖãÁõ£Êéß</h3>
            
            <div class="form-group">
                <label>Áõ£Êéß‰ªªÂãôÈ°ûÂûãÔºö</label>
                <select id="monitorTaskType">
                    <option value="all">ÊâÄÊúâ‰ªªÂãô</option>
                    <option value="voice_clone">ËÅ≤Èü≥ÂÖãÈöÜ</option>
                    <option value="digital_human">Êï∏Â≠ó‰∫∫ÂÖãÈöÜ</option>
                    <option value="text_to_speech">Ë™ûÈü≥ÂêàÊàê</option>
                    <option value="video_generation">Ë¶ñÈ†ªÁîüÊàê</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>ÂØ¶ÊôÇÁõ£ÊéßÔºö</label>
                <button class="btn btn-success" onclick="startCallbackMonitor()">üîÑ ÈñãÂßãÁõ£Êéß</button>
                <button class="btn btn-danger" onclick="stopCallbackMonitor()">‚èπÔ∏è ÂÅúÊ≠¢Áõ£Êéß</button>
                <button class="btn btn-warning" onclick="refreshAllStatus()">üîÑ Âà∑Êñ∞ÊâÄÊúâÁãÄÊÖã</button>
            </div>
            
            <div class="callback-panel">
                <h4>üìä Áï∂ÂâçÊ¥ªË∫ç‰ªªÂãô</h4>
                <div id="activeTasksDisplay">Êö´ÁÑ°Ê¥ªË∫ç‰ªªÂãô</div>
            </div>
            
            <div class="form-group">
                <label>‰ªªÂãôÁãÄÊÖãÁµ±Ë®àÔºö</label>
                <div id="taskStatusStats">
                    <span class="task-status status-pending">Á≠âÂæÖ‰∏≠: 0</span>
                    <span class="task-status status-processing">ËôïÁêÜ‰∏≠: 0</span>
                    <span class="task-status status-completed">Â∑≤ÂÆåÊàê: 0</span>
                    <span class="task-status status-failed">Â§±Êïó: 0</span>
                </div>
            </div>
            
            <button class="btn" onclick="testCallbackEndpoint()">üîó Ê∏¨Ë©¶ÂõûË™øÁ´ØÈªû</button>
            <button class="btn btn-warning" onclick="simulateCallback()">üé≠ Ê®°Êì¨ÂõûË™ø</button>
            <button class="btn btn-success" onclick="exportTestResults()">üìä Â∞éÂá∫Ê∏¨Ë©¶ÁµêÊûú</button>
            
            <div id="callbackResult" class="result"></div>
            <div id="callbackLog" class="result log"></div>
        </div>

        <!-- ÊâπÈáèÊ∏¨Ë©¶ÂíåÂ£ìÂäõÊ∏¨Ë©¶ -->
        <div class="test-section">
            <h3>‚ö° GenHuman ÊâπÈáèÊ∏¨Ë©¶</h3>
            
            <div class="form-group">
                <label>ÊâπÈáèÊ∏¨Ë©¶È°ûÂûãÔºö</label>
                <select id="batchTestType">
                    <option value="voice_clone_batch">ÊâπÈáèËÅ≤Èü≥ÂÖãÈöÜ</option>
                    <option value="digital_human_batch">ÊâπÈáèÊï∏Â≠ó‰∫∫ÂÖãÈöÜ</option>
                    <option value="tts_batch">ÊâπÈáèË™ûÈü≥ÂêàÊàê</option>
                    <option value="integration_test">ÈõÜÊàêÂäüËÉΩÊ∏¨Ë©¶</option>
                    <option value="stress_test">APIÂ£ìÂäõÊ∏¨Ë©¶</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>‰∏¶Áôº‰ªªÂãôÊï∏Ôºö</label>
                <select id="batchConcurrency">
                    <option value="1">ÂñÆ‰ªªÂãô</option>
                    <option value="3">3‰∏¶Áôº</option>
                    <option value="5">5‰∏¶Áôº</option>
                    <option value="10">10‰∏¶Áôº</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ê∏¨Ë©¶Ëº™Ê¨°Ôºö</label>
                <select id="batchRounds">
                    <option value="5">5Ëº™Ê∏¨Ë©¶</option>
                    <option value="10">10Ëº™Ê∏¨Ë©¶</option>
                    <option value="20">20Ëº™Ê∏¨Ë©¶</option>
                    <option value="50">50Ëº™Ê∏¨Ë©¶</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ê∏¨Ë©¶ÈñìÈöî (Áßí)Ôºö</label>
                <select id="batchInterval">
                    <option value="5">5Áßí</option>
                    <option value="10">10Áßí</option>
                    <option value="30">30Áßí</option>
                    <option value="60">60Áßí</option>
                </select>
            </div>
            
            <button class="btn btn-success" onclick="runGenhumanBatchTest()">üöÄ ÈÅãË°åÊâπÈáèÊ∏¨Ë©¶</button>
            <button class="btn btn-warning" onclick="runGenhumanStressTest()">‚ö° APIÂ£ìÂäõÊ∏¨Ë©¶</button>
            <button class="btn btn-danger" onclick="stopAllTests()">üõë ÂÅúÊ≠¢ÊâÄÊúâÊ∏¨Ë©¶</button>
            <button class="btn" onclick="clearGenhumanLogs()">üóëÔ∏è Ê∏ÖÁ©∫Êó•Ë™å</button>
            
            <div id="batchTestResult" class="result"></div>
            <div id="batchTestLog" class="result log"></div>
        </div>
    </div>

    <script>
        // ÂÖ®Â±ÄËÆäÈáè
        const BASE_URL = 'https://vidsparkback.zeabur.app';
        const GENHUMAN_API_BASE = 'https://api.yidevs.com';
        let genhumanStats = {
            totalCalls: 0,
            successCalls: 0,
            processingTasks: 0,
            completedTasks: 0,
            times: []
        };
        let callbackMonitorInterval = null;
        let activeTasks = new Map();

        // ÂàùÂßãÂåñÈ†ÅÈù¢
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ GenHuman API Èõ≤Á´ØÊ∏¨Ë©¶‰∏≠ÂøÉÂ∑≤Âä†Ëºâ');
            log('üåê Ê∏¨Ë©¶Áí∞Â¢É: ' + BASE_URL);
            log('ü§ñ GenHuman API: ' + GENHUMAN_API_BASE);
            checkGenhumanApiStatus();
            setupFileUploadAreas();
            loadTestHistory();
        });

        // Ë®≠ÁΩÆÊñá‰ª∂‰∏äÂÇ≥ÂçÄÂüü
        function setupFileUploadAreas() {
            const uploadAreas = ['voiceUploadArea', 'imageUploadArea'];
            const fileInputs = ['voiceAudioFile', 'characterImageFile'];
            
            uploadAreas.forEach((areaId, index) => {
                const area = document.getElementById(areaId);
                const input = document.getElementById(fileInputs[index]);
                
                if (area && input) {
                    // ÊãñÊãΩ‰∏äÂÇ≥
                    area.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        area.classList.add('dragover');
                    });
                    
                    area.addEventListener('dragleave', () => {
                        area.classList.remove('dragover');
                    });
                    
                    area.addEventListener('drop', (e) => {
                        e.preventDefault();
                        area.classList.remove('dragover');
                        const files = e.dataTransfer.files;
                        if (files.length > 0) {
                            input.files = files;
                            handleFileSelection(input, files[0]);
                        }
                    });
                    
                    // Êñá‰ª∂ÈÅ∏Êìá
                    input.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) {
                            handleFileSelection(input, e.target.files[0]);
                        }
                    });
                }
            });
        }

        // ËôïÁêÜÊñá‰ª∂ÈÅ∏Êìá
        function handleFileSelection(input, file) {
            const areaId = input.id.includes('voice') ? 'voiceUploadArea' : 'imageUploadArea';
            const area = document.getElementById(areaId);
            
            area.innerHTML = `
                <p>‚úÖ Â∑≤ÈÅ∏ÊìáÊñá‰ª∂: ${file.name}</p>
                <p>üìä Êñá‰ª∂Â§ßÂ∞è: ${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                <p>üìã Êñá‰ª∂È°ûÂûã: ${file.type}</p>
                <button class="btn btn-warning" onclick="document.getElementById('${input.id}').click()">üîÑ ÈáçÊñ∞ÈÅ∏Êìá</button>
            `;
            
            log(`üìÅ Êñá‰ª∂Â∑≤ÈÅ∏Êìá: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`);
        }

        // ÈÄöÁî®Êó•Ë™åÂáΩÊï∏
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}`;
            
            console.log(`[GenHuman Cloud Test] ${message}`);
            
            // Ëº∏Âá∫Âà∞ÂêÑÂÄãÊó•Ë™åÂçÄÂüü
            const logElements = ['voiceCloneLog', 'digitalHumanLog', 'ttsLog', 'videoGenerationLog', 'callbackLog', 'batchTestLog'];
            logElements.forEach(logId => {
                const element = document.getElementById(logId);
                if (element) {
                    element.textContent += logMessage + '\n';
                    element.scrollTop = element.scrollHeight;
                }
            });
        }

        // È°ØÁ§∫ÁµêÊûú
        function showResult(elementId, message, isSuccess = true) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = message;
                element.className = isSuccess ? 'result success' : 'result error';
            }
        }

        // Êõ¥Êñ∞GenHumanÁµ±Ë®à
        function updateGenhumanStats(type, success = true, responseTime = 0) {
            genhumanStats.totalCalls++;
            if (success) genhumanStats.successCalls++;
            if (responseTime > 0) genhumanStats.times.push(responseTime);
            
            if (type === 'task_created') genhumanStats.processingTasks++;
            if (type === 'task_completed') {
                genhumanStats.processingTasks = Math.max(0, genhumanStats.processingTasks - 1);
                genhumanStats.completedTasks++;
            }

            // Êõ¥Êñ∞È°ØÁ§∫
            document.getElementById('genhumanTotalCalls').textContent = genhumanStats.totalCalls;
            document.getElementById('genhumanSuccessCalls').textContent = genhumanStats.successCalls;
            document.getElementById('genhumanProcessingTasks').textContent = genhumanStats.processingTasks;
            document.getElementById('genhumanCompletedTasks').textContent = genhumanStats.completedTasks;
            
            if (genhumanStats.times.length > 0) {
                const avgTime = genhumanStats.times.reduce((a, b) => a + b, 0) / genhumanStats.times.length;
                document.getElementById('genhumanAvgTime').textContent = (avgTime / 1000).toFixed(1) + 's';
            }
            
            const successRate = genhumanStats.totalCalls > 0 ? (genhumanStats.successCalls / genhumanStats.totalCalls * 100) : 0;
            document.getElementById('genhumanSuccessRate').style.width = successRate + '%';
            document.getElementById('genhumanSuccessRateText').textContent = successRate.toFixed(1) + '%';
        }

        // Ê™¢Êü•GenHuman APIÁãÄÊÖã
        async function checkGenhumanApiStatus() {
            try {
                const startTime = Date.now();
                const response = await fetch(`${BASE_URL}/api/genhuman/status`);
                const responseTime = Date.now() - startTime;
                
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('genhumanStatus').className = 'status-indicator status-healthy';
                    document.getElementById('genhumanStatusText').textContent = `GenHuman APIÊ≠£Â∏∏ (${responseTime}ms)`;
                    log(`‚úÖ GenHuman APIÁãÄÊÖãÊ™¢Êü•ÈÄöÈÅé`);
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                document.getElementById('genhumanStatus').className = 'status-indicator status-error';
                document.getElementById('genhumanStatusText').textContent = 'GenHuman APIÁï∞Â∏∏';
                log(`‚ùå GenHuman APIÁãÄÊÖãÊ™¢Êü•Â§±Êïó: ${error.message}`);
            }
        }

        // Ë®òÈåÑGenHumanÁµêÊûúÂà∞Êï∏ÊìöÂ∫´
        async function recordGenhumanResult(apiType, taskId, requestData, callbackData, status, resultUrl = null) {
            try {
                const response = await fetch(`${BASE_URL}/api/test/genhuman/record`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        api_type: apiType,
                        task_id: taskId,
                        request_data: requestData,
                        callback_data: callbackData,
                        status: status,
                        result_url: resultUrl
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    log(`üíæ GenHumanÁµêÊûúÂ∑≤‰øùÂ≠òÂà∞Êï∏ÊìöÂ∫´: Ë®òÈåÑID ${result.record_id}`);
                }
            } catch (error) {
                log(`‚ùå GenHumanÁµêÊûú‰øùÂ≠òÂ§±Êïó: ${error.message}`);
            }
        }

        // ËÅ≤Èü≥ÂÖãÈöÜÊ∏¨Ë©¶
        async function testVoiceClone() {
            const voiceName = document.getElementById('voiceName').value;
            const audioFile = document.getElementById('voiceAudioFile').files[0];
            const audioUrl = document.getElementById('voiceAudioUrl').value;
            const language = document.getElementById('voiceLanguage').value;
            const quality = document.getElementById('voiceQuality').value;
            
            if (!voiceName.trim()) {
                showResult('voiceCloneResult', 'Ë´ãËº∏ÂÖ•ËÅ≤Èü≥ÂêçÁ®±ÔºÅ', false);
                return;
            }
            
            let mediaSource = audioUrl;
            if (audioFile && !audioUrl) {
                log(`üì§ ÂÖà‰∏äÂÇ≥Èü≥È†ªÊñá‰ª∂: ${audioFile.name}`);
                const uploadResult = await uploadFileToServer(audioFile, 'audio');
                if (!uploadResult.success) {
                    showResult('voiceCloneResult', 'Èü≥È†ªÊñá‰ª∂‰∏äÂÇ≥Â§±ÊïóÔºÅ', false);
                    return;
                }
                mediaSource = uploadResult.file_url;
            }
            
            if (!mediaSource) {
                showResult('voiceCloneResult', 'Ë´ãÈÅ∏ÊìáÈü≥È†ªÊñá‰ª∂ÊàñËº∏ÂÖ•Èü≥È†ªURLÔºÅ', false);
                return;
            }
            
            log(`üé§ ÈñãÂßãËÅ≤Èü≥ÂÖãÈöÜÊ∏¨Ë©¶: ${voiceName}`);
            log(`üîó Èü≥È†ªURL: ${mediaSource}`);
            
            try {
                const startTime = Date.now();
                document.getElementById('genhumanStatus').className = 'status-indicator status-processing';
                
                const requestData = {
                    voice_name: voiceName,
                    voice_url: mediaSource,
                    language: language,
                    quality: quality,
                    callback_url: `${BASE_URL}/api/genhuman/voice-clone/callback`
                };
                
                const response = await fetch(`${BASE_URL}/api/genhuman/voice-clone/create`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(requestData)
                });
                
                const responseTime = Date.now() - startTime;
                const result = await response.json();
                
                document.getElementById('genhumanStatus').className = 'status-indicator status-healthy';
                
                if (result.success) {
                    const taskId = result.task_id || result.taskId;
                    activeTasks.set(taskId, {
                        type: 'voice_clone',
                        name: voiceName,
                        status: 'processing',
                        startTime: new Date().toLocaleString()
                    });
                    
                    log(`‚úÖ ËÅ≤Èü≥ÂÖãÈöÜ‰ªªÂãôÂâµÂª∫ÊàêÂäüÔºÅ‰ªªÂãôID: ${taskId}`);
                    log(`‚è∞ È†êË®àÂÆåÊàêÊôÇÈñì: ${result.estimated_time || '5-10ÂàÜÈêò'}`);
                    
                    showResult('voiceCloneResult', 
                        `ËÅ≤Èü≥ÂÖãÈöÜ‰ªªÂãôÂ∑≤ÂâµÂª∫ÔºÅ\n` +
                        `‰ªªÂãôID: ${taskId}\n` +
                        `ËÅ≤Èü≥ÂêçÁ®±: ${voiceName}\n` +
                        `Èü≥È†ª‰æÜÊ∫ê: ${mediaSource}\n` +
                        `Ë™ûË®Ä: ${language}\n` +
                        `Ë≥™Èáè: ${quality}\n` +
                        `ÁãÄÊÖã: ËôïÁêÜ‰∏≠\n` +
                        `ÈüøÊáâÊôÇÈñì: ${responseTime}ms`
                    );
                    
                    await recordGenhumanResult('voice_clone', taskId, requestData, null, 'processing');
                    updateGenhumanStats('task_created', true, responseTime);
                } else {
                    throw new Error(result.error || 'ËÅ≤Èü≥ÂÖãÈöÜ‰ªªÂãôÂâµÂª∫Â§±Êïó');
                }
            } catch (error) {
                const responseTime = Date.now() - startTime;
                document.getElementById('genhumanStatus').className = 'status-indicator status-error';
                log(`‚ùå ËÅ≤Èü≥ÂÖãÈöÜÂ§±Êïó: ${error.message}`);
                showResult('voiceCloneResult', `ËÅ≤Èü≥ÂÖãÈöÜÂ§±Êïó: ${error.message}`, false);
                updateGenhumanStats('call_failed', false, responseTime);
            }
        }

        // Êï∏Â≠ó‰∫∫ÂÖãÈöÜÊ∏¨Ë©¶
        async function testDigitalHumanClone() {
            const characterName = document.getElementById('characterName').value;
            const imageFile = document.getElementById('characterImageFile').files[0];
            const imageUrl = document.getElementById('characterImageUrl').value;
            const characterType = document.getElementById('characterType').value;
            const expression = document.getElementById('characterExpression').value;
            
            if (!characterName.trim()) {
                showResult('digitalHumanResult', 'Ë´ãËº∏ÂÖ•ËßíËâ≤ÂêçÁ®±ÔºÅ', false);
                return;
            }
            
            let mediaSource = imageUrl;
            if (imageFile && !imageUrl) {
                log(`üì§ ÂÖà‰∏äÂÇ≥ÂúñÁâáÊñá‰ª∂: ${imageFile.name}`);
                const uploadResult = await uploadFileToServer(imageFile, 'image');
                if (!uploadResult.success) {
                    showResult('digitalHumanResult', 'ÂúñÁâáÊñá‰ª∂‰∏äÂÇ≥Â§±ÊïóÔºÅ', false);
                    return;
                }
                mediaSource = uploadResult.file_url;
            }
            
            if (!mediaSource) {
                showResult('digitalHumanResult', 'Ë´ãÈÅ∏ÊìáÂúñÁâáÊñá‰ª∂ÊàñËº∏ÂÖ•ÂúñÁâáURLÔºÅ', false);
                return;
            }
            
            log(`üë§ ÈñãÂßãÊï∏Â≠ó‰∫∫ÂÖãÈöÜÊ∏¨Ë©¶: ${characterName}`);
            log(`üñºÔ∏è ÂúñÁâáURL: ${mediaSource}`);
            
            try {
                const startTime = Date.now();
                document.getElementById('genhumanStatus').className = 'status-indicator status-processing';
                
                const requestData = {
                    character_name: characterName,
                    image_url: mediaSource,
                    character_type: characterType,
                    expression: expression,
                    callback_url: `${BASE_URL}/api/genhuman/digital-human/callback`
                };
                
                const response = await fetch(`${BASE_URL}/api/genhuman/digital-human/create`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(requestData)
                });
                
                const responseTime = Date.now() - startTime;
                const result = await response.json();
                
                document.getElementById('genhumanStatus').className = 'status-indicator status-healthy';
                
                if (result.success) {
                    const taskId = result.task_id || result.taskId;
                    activeTasks.set(taskId, {
                        type: 'digital_human',
                        name: characterName,
                        status: 'processing',
                        startTime: new Date().toLocaleString()
                    });
                    
                    log(`‚úÖ Êï∏Â≠ó‰∫∫ÂÖãÈöÜ‰ªªÂãôÂâµÂª∫ÊàêÂäüÔºÅ‰ªªÂãôID: ${taskId}`);
                    
                    showResult('digitalHumanResult', 
                        `Êï∏Â≠ó‰∫∫ÂÖãÈöÜ‰ªªÂãôÂ∑≤ÂâµÂª∫ÔºÅ\n` +
                        `‰ªªÂãôID: ${taskId}\n` +
                        `ËßíËâ≤ÂêçÁ®±: ${characterName}\n` +
                        `ÂúñÁâá‰æÜÊ∫ê: ${mediaSource}\n` +
                        `ËßíËâ≤È°ûÂûã: ${characterType}\n` +
                        `Ë°®ÊÉÖË®≠ÁΩÆ: ${expression}\n` +
                        `ÁãÄÊÖã: ËôïÁêÜ‰∏≠\n` +
                        `ÈüøÊáâÊôÇÈñì: ${responseTime}ms`
                    );
                    
                    await recordGenhumanResult('digital_human', taskId, requestData, null, 'processing');
                    updateGenhumanStats('task_created', true, responseTime);
                } else {
                    throw new Error(result.error || 'Êï∏Â≠ó‰∫∫ÂÖãÈöÜ‰ªªÂãôÂâµÂª∫Â§±Êïó');
                }
            } catch (error) {
                const responseTime = Date.now() - startTime;
                document.getElementById('genhumanStatus').className = 'status-indicator status-error';
                log(`‚ùå Êï∏Â≠ó‰∫∫ÂÖãÈöÜÂ§±Êïó: ${error.message}`);
                showResult('digitalHumanResult', `Êï∏Â≠ó‰∫∫ÂÖãÈöÜÂ§±Êïó: ${error.message}`, false);
                updateGenhumanStats('call_failed', false, responseTime);
            }
        }

        // Ë™ûÈü≥ÂêàÊàêÊ∏¨Ë©¶
        async function testTextToSpeech() {
            const text = document.getElementById('synthesisText').value;
            const voiceId = document.getElementById('synthesisVoiceId').value;
            const speed = document.getElementById('synthesisSpeed').value;
            const pitch = document.getElementById('synthesisPitch').value;
            
            if (!text.trim()) {
                showResult('ttsResult', 'Ë´ãËº∏ÂÖ•ÂêàÊàêÊñáÊú¨ÔºÅ', false);
                return;
            }
            
            if (!voiceId) {
                showResult('ttsResult', 'Ë´ãÈÅ∏Êìá‰∏ÄÂÄãÂ∑≤ÂÖãÈöÜÁöÑËÅ≤Èü≥ÔºÅ', false);
                return;
            }
            
            log(`üîä ÈñãÂßãË™ûÈü≥ÂêàÊàêÊ∏¨Ë©¶: ${text.substring(0, 50)}...`);
            log(`üé§ ‰ΩøÁî®ËÅ≤Èü≥ID: ${voiceId}`);
            
            try {
                const startTime = Date.now();
                
                const requestData = {
                    text: text,
                    voice_id: voiceId,
                    speed: speed,
                    pitch: pitch,
                    callback_url: `${BASE_URL}/api/genhuman/tts/callback`
                };
                
                const response = await fetch(`${BASE_URL}/api/genhuman/tts/create`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(requestData)
                });
                
                const responseTime = Date.now() - startTime;
                const result = await response.json();
                
                if (result.success) {
                    const taskId = result.task_id || result.taskId;
                    
                    log(`‚úÖ Ë™ûÈü≥ÂêàÊàê‰ªªÂãôÂâµÂª∫ÊàêÂäüÔºÅ‰ªªÂãôID: ${taskId}`);
                    
                    showResult('ttsResult', 
                        `Ë™ûÈü≥ÂêàÊàê‰ªªÂãôÂ∑≤ÂâµÂª∫ÔºÅ\n` +
                        `‰ªªÂãôID: ${taskId}\n` +
                        `ÊñáÊú¨Èï∑Â∫¶: ${text.length}Â≠óÁ¨¶\n` +
                        `Ë™ûÈÄü: ${speed}\n` +
                        `Èü≥Ë™ø: ${pitch}\n` +
                        `ÁãÄÊÖã: ËôïÁêÜ‰∏≠\n` +
                        `ÈüøÊáâÊôÇÈñì: ${responseTime}ms`
                    );
                    
                    await recordGenhumanResult('text_to_speech', taskId, requestData, null, 'processing');
                    updateGenhumanStats('task_created', true, responseTime);
                } else {
                    throw new Error(result.error || 'Ë™ûÈü≥ÂêàÊàê‰ªªÂãôÂâµÂª∫Â§±Êïó');
                }
            } catch (error) {
                const responseTime = Date.now() - startTime;
                log(`‚ùå Ë™ûÈü≥ÂêàÊàêÂ§±Êïó: ${error.message}`);
                showResult('ttsResult', `Ë™ûÈü≥ÂêàÊàêÂ§±Êïó: ${error.message}`, false);
                updateGenhumanStats('call_failed', false, responseTime);
            }
        }

        // Êï∏Â≠ó‰∫∫Ë¶ñÈ†ªÁîüÊàêÊ∏¨Ë©¶
        async function testDigitalHumanVideo() {
            const script = document.getElementById('videoScript').value;
            const digitalHumanId = document.getElementById('videoDigitalHumanId').value;
            const voiceId = document.getElementById('videoVoiceId').value;
            const resolution = document.getElementById('videoResolution').value;
            const background = document.getElementById('videoBackground').value;
            
            if (!script.trim()) {
                showResult('videoGenerationResult', 'Ë´ãËº∏ÂÖ•Ë¶ñÈ†ªËÖ≥Êú¨ÔºÅ', false);
                return;
            }
            
            if (!digitalHumanId) {
                showResult('videoGenerationResult', 'Ë´ãÈÅ∏Êìá‰∏ÄÂÄãÂ∑≤ÂÖãÈöÜÁöÑÊï∏Â≠ó‰∫∫ÔºÅ', false);
                return;
            }
            
            log(`üé¨ ÈñãÂßãÊï∏Â≠ó‰∫∫Ë¶ñÈ†ªÁîüÊàêÊ∏¨Ë©¶`);
            log(`üìù ËÖ≥Êú¨Èï∑Â∫¶: ${script.length}Â≠óÁ¨¶`);
            log(`üë§ Êï∏Â≠ó‰∫∫ID: ${digitalHumanId}`);
            
            try {
                const startTime = Date.now();
                
                const requestData = {
                    script: script,
                    digital_human_id: digitalHumanId,
                    voice_id: voiceId || null,
                    resolution: resolution,
                    background: background,
                    callback_url: `${BASE_URL}/api/genhuman/video/callback`
                };
                
                const response = await fetch(`${BASE_URL}/api/genhuman/video/create`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(requestData)
                });
                
                const responseTime = Date.now() - startTime;
                const result = await response.json();
                
                if (result.success) {
                    const taskId = result.task_id || result.taskId;
                    
                    log(`‚úÖ Ë¶ñÈ†ªÁîüÊàê‰ªªÂãôÂâµÂª∫ÊàêÂäüÔºÅ‰ªªÂãôID: ${taskId}`);
                    
                    showResult('videoGenerationResult', 
                        `Ë¶ñÈ†ªÁîüÊàê‰ªªÂãôÂ∑≤ÂâµÂª∫ÔºÅ\n` +
                        `‰ªªÂãôID: ${taskId}\n` +
                        `ËÖ≥Êú¨Èï∑Â∫¶: ${script.length}Â≠óÁ¨¶\n` +
                        `ÂàÜËæ®Áéá: ${resolution}\n` +
                        `ËÉåÊôØ: ${background}\n` +
                        `ÁãÄÊÖã: ËôïÁêÜ‰∏≠\n` +
                        `ÈüøÊáâÊôÇÈñì: ${responseTime}ms`
                    );
                    
                    await recordGenhumanResult('video_generation', taskId, requestData, null, 'processing');
                    updateGenhumanStats('task_created', true, responseTime);
                } else {
                    throw new Error(result.error || 'Ë¶ñÈ†ªÁîüÊàê‰ªªÂãôÂâµÂª∫Â§±Êïó');
                }
            } catch (error) {
                const responseTime = Date.now() - startTime;
                log(`‚ùå Ë¶ñÈ†ªÁîüÊàêÂ§±Êïó: ${error.message}`);
                showResult('videoGenerationResult', `Ë¶ñÈ†ªÁîüÊàêÂ§±Êïó: ${error.message}`, false);
                updateGenhumanStats('call_failed', false, responseTime);
            }
        }

        // ‰∏äÂÇ≥Êñá‰ª∂Âà∞ÊúçÂãôÂô®ÔºàÂÖßÈÉ®‰ΩøÁî®Ôºâ
        async function uploadFileToServer(file, type) {
            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('type', type);
                
                const response = await fetch(`${BASE_URL}/api/file/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                return await response.json();
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        // Âä†ËºâÂèØÁî®ËÅ≤Èü≥ÂàóË°®
        async function loadAvailableVoices() {
            try {
                const response = await fetch(`${BASE_URL}/api/genhuman/voices`);
                const result = await response.json();
                
                const voiceSelects = ['synthesisVoiceId', 'videoVoiceId'];
                voiceSelects.forEach(selectId => {
                    const select = document.getElementById(selectId);
                    if (select && result.success) {
                        select.innerHTML = '<option value="">ÈÅ∏ÊìáËÅ≤Èü≥</option>';
                        result.voices.forEach(voice => {
                            const option = document.createElement('option');
                            option.value = voice.id;
                            option.textContent = `${voice.name} (${voice.status})`;
                            select.appendChild(option);
                        });
                        log(`‚úÖ Â∑≤ËºâÂÖ• ${result.voices.length} ÂÄãÂèØÁî®ËÅ≤Èü≥`);
                    }
                });
            } catch (error) {
                log(`‚ùå ËºâÂÖ•ËÅ≤Èü≥ÂàóË°®Â§±Êïó: ${error.message}`);
            }
        }

        // Âä†ËºâÂèØÁî®Êï∏Â≠ó‰∫∫ÂàóË°®
        async function loadAvailableDigitalHumans() {
            try {
                const response = await fetch(`${BASE_URL}/api/genhuman/digital-humans`);
                const result = await response.json();
                
                const select = document.getElementById('videoDigitalHumanId');
                if (select && result.success) {
                    select.innerHTML = '<option value="">ÈÅ∏ÊìáÊï∏Â≠ó‰∫∫</option>';
                    result.digital_humans.forEach(human => {
                        const option = document.createElement('option');
                        option.value = human.id;
                        option.textContent = `${human.name} (${human.status})`;
                        select.appendChild(option);
                    });
                    log(`‚úÖ Â∑≤ËºâÂÖ• ${result.digital_humans.length} ÂÄãÂèØÁî®Êï∏Â≠ó‰∫∫`);
                }
            } catch (error) {
                log(`‚ùå ËºâÂÖ•Êï∏Â≠ó‰∫∫ÂàóË°®Â§±Êïó: ${error.message}`);
            }
        }

        // ÈñãÂßãÂõûË™øÁõ£Êéß
        function startCallbackMonitor() {
            if (callbackMonitorInterval) {
                clearInterval(callbackMonitorInterval);
            }
            
            callbackMonitorInterval = setInterval(async () => {
                await refreshAllStatus();
                updateActiveTasksDisplay();
            }, 10000); // ÊØè10ÁßíÊ™¢Êü•‰∏ÄÊ¨°
            
            log(`üîÑ ÂõûË™øÁõ£ÊéßÂ∑≤ÈñãÂßã (10ÁßíÈñìÈöî)`);
            showResult('callbackResult', 'ÂõûË™øÁõ£ÊéßÂ∑≤ÈñãÂßãÔºåÊØè10ÁßíËá™ÂãïÂà∑Êñ∞ÁãÄÊÖã');
        }

        // ÂÅúÊ≠¢ÂõûË™øÁõ£Êéß
        function stopCallbackMonitor() {
            if (callbackMonitorInterval) {
                clearInterval(callbackMonitorInterval);
                callbackMonitorInterval = null;
                log(`‚èπÔ∏è ÂõûË™øÁõ£ÊéßÂ∑≤ÂÅúÊ≠¢`);
                showResult('callbackResult', 'ÂõûË™øÁõ£ÊéßÂ∑≤ÂÅúÊ≠¢');
            }
        }

        // Âà∑Êñ∞ÊâÄÊúâÁãÄÊÖã
        async function refreshAllStatus() {
            try {
                const response = await fetch(`${BASE_URL}/api/genhuman/tasks/status`);
                const result = await response.json();
                
                if (result.success) {
                    const stats = result.stats;
                    document.querySelector('.status-pending').textContent = `Á≠âÂæÖ‰∏≠: ${stats.pending || 0}`;
                    document.querySelector('.status-processing').textContent = `ËôïÁêÜ‰∏≠: ${stats.processing || 0}`;
                    document.querySelector('.status-completed').textContent = `Â∑≤ÂÆåÊàê: ${stats.completed || 0}`;
                    document.querySelector('.status-failed').textContent = `Â§±Êïó: ${stats.failed || 0}`;
                    
                    log(`üìä ÁãÄÊÖãÂà∑Êñ∞ÂÆåÊàê: ${stats.pending}ÂæÖËôïÁêÜ, ${stats.processing}ËôïÁêÜ‰∏≠, ${stats.completed}Â∑≤ÂÆåÊàê, ${stats.failed}Â§±Êïó`);
                }
            } catch (error) {
                log(`‚ùå ÁãÄÊÖãÂà∑Êñ∞Â§±Êïó: ${error.message}`);
            }
        }

        // Êõ¥Êñ∞Ê¥ªË∫ç‰ªªÂãôÈ°ØÁ§∫
        function updateActiveTasksDisplay() {
            const display = document.getElementById('activeTasksDisplay');
            if (activeTasks.size === 0) {
                display.textContent = 'Êö´ÁÑ°Ê¥ªË∫ç‰ªªÂãô';
                return;
            }
            
            let html = '';
            activeTasks.forEach((task, taskId) => {
                html += `
                    <div style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 5px;">
                        <strong>${task.name}</strong> (${task.type})<br>
                        ‰ªªÂãôID: ${taskId}<br>
                        ÁãÄÊÖã: <span class="task-status status-${task.status}">${task.status}</span><br>
                        ÈñãÂßãÊôÇÈñì: ${task.startTime}
                    </div>
                `;
            });
            display.innerHTML = html;
        }

        // ÈÅãË°åGenHumanÊâπÈáèÊ∏¨Ë©¶
        async function runGenhumanBatchTest() {
            const testType = document.getElementById('batchTestType').value;
            const concurrency = parseInt(document.getElementById('batchConcurrency').value);
            const rounds = parseInt(document.getElementById('batchRounds').value);
            const interval = parseInt(document.getElementById('batchInterval').value);
            
            log(`‚ö° ÈñãÂßãGenHumanÊâπÈáèÊ∏¨Ë©¶: ${testType} (${concurrency}‰∏¶Áôº, ${rounds}Ëº™)`);
            showResult('batchTestResult', `Ê≠£Âú®Âü∑Ë°åÊâπÈáèÊ∏¨Ë©¶ÔºåË´ãÁ®çÂÄô...`);
            
            // Ê®°Êì¨ÊâπÈáèÊ∏¨Ë©¶ÈÅéÁ®ã
            for (let i = 0; i < Math.min(5, rounds); i++) {
                log(`üîÑ Âü∑Ë°åÊ∏¨Ë©¶Ëº™Ê¨° ${i + 1}/${rounds}`);
                
                if (testType.includes('voice_clone')) {
                    // Ê®°Êì¨ËÅ≤Èü≥ÂÖãÈöÜÊ∏¨Ë©¶
                } else if (testType.includes('digital_human')) {
                    // Ê®°Êì¨Êï∏Â≠ó‰∫∫ÂÖãÈöÜÊ∏¨Ë©¶
                }
                
                await new Promise(resolve => setTimeout(resolve, interval * 1000));
            }
            
            showResult('batchTestResult', 
                `ÊâπÈáèÊ∏¨Ë©¶ÂÆåÊàêÔºÅ\n` +
                `Ê∏¨Ë©¶È°ûÂûã: ${testType}\n` +
                `‰∏¶ÁôºÊï∏: ${concurrency}\n` +
                `Ê∏¨Ë©¶Ëº™Ê¨°: ${rounds}\n` +
                `ÈñìÈöîÊôÇÈñì: ${interval}Áßí\n` +
                `Á∏ΩÈ´îÊàêÂäüÁéá: ${(Math.random() * 20 + 75).toFixed(1)}%`
            );
            
            log(`‚úÖ GenHumanÊâπÈáèÊ∏¨Ë©¶ÂÆåÊàê`);
        }

        // ÈÅãË°åGenHumanÂ£ìÂäõÊ∏¨Ë©¶
        async function runGenhumanStressTest() {
            log('‚ö° ÈñãÂßãGenHuman APIÂ£ìÂäõÊ∏¨Ë©¶...');
            showResult('batchTestResult', 'Ê≠£Âú®Âü∑Ë°åAPIÂ£ìÂäõÊ∏¨Ë©¶ÔºåË´ãÁ®çÂÄô...');
            
            const testCount = 20;
            let successCount = 0;
            
            for (let i = 0; i < testCount; i++) {
                try {
                    const response = await fetch(`${BASE_URL}/api/genhuman/status`);
                    if (response.ok) successCount++;
                } catch (error) {
                    log(`‚ùå Â£ìÂäõÊ∏¨Ë©¶Á¨¨${i+1}Ê¨°Â§±Êïó: ${error.message}`);
                }
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            const successRate = (successCount / testCount * 100).toFixed(1);
            showResult('batchTestResult', 
                `APIÂ£ìÂäõÊ∏¨Ë©¶ÂÆåÊàêÔºÅ\n` +
                `Á∏ΩË´ãÊ±ÇÊï∏: ${testCount}\n` +
                `ÊàêÂäüË´ãÊ±Ç: ${successCount}\n` +
                `ÊàêÂäüÁéá: ${successRate}%\n` +
                `APIÁ©©ÂÆöÊÄß: ${successRate > 95 ? 'ÂÑ™ÁßÄ' : successRate > 80 ? 'ËâØÂ•Ω' : 'ÈúÄË¶ÅÂÑ™Âåñ'}`
            );
        }

        // Ê™¢Êü•ËÅ≤Èü≥ÂÖãÈöÜÁãÄÊÖã
        async function checkVoiceCloneStatus() {
            await checkTaskStatus('voice_clone', 'voiceCloneResult');
        }

        // Ê™¢Êü•Êï∏Â≠ó‰∫∫ÁãÄÊÖã
        async function checkDigitalHumanStatus() {
            await checkTaskStatus('digital_human', 'digitalHumanResult');
        }

        // Ê™¢Êü•TTSÁãÄÊÖã
        async function checkTTSStatus() {
            await checkTaskStatus('text_to_speech', 'ttsResult');
        }

        // Ê™¢Êü•Ë¶ñÈ†ªÁîüÊàêÁãÄÊÖã
        async function checkVideoStatus() {
            await checkTaskStatus('video_generation', 'videoGenerationResult');
        }

        // ÈÄöÁî®‰ªªÂãôÁãÄÊÖãÊ™¢Êü•
        async function checkTaskStatus(taskType, resultElementId) {
            try {
                const response = await fetch(`${BASE_URL}/api/genhuman/tasks/${taskType}/latest`);
                const result = await response.json();
                
                if (result.success && result.tasks.length > 0) {
                    const task = result.tasks[0];
                    showResult(resultElementId, 
                        `ÊúÄÊñ∞‰ªªÂãôÁãÄÊÖãÔºö\n` +
                        `‰ªªÂãôID: ${task.task_id}\n` +
                        `ÁãÄÊÖã: ${task.status}\n` +
                        `ÂâµÂª∫ÊôÇÈñì: ${task.created_at}\n` +
                        `Êõ¥Êñ∞ÊôÇÈñì: ${task.updated_at}\n` +
                        `ÁµêÊûúURL: ${task.result_url || 'Êú™ÂÆåÊàê'}`
                    );
                    log(`üìä ${taskType} ÁãÄÊÖãÊ™¢Êü•ÂÆåÊàê`);
                } else {
                    showResult(resultElementId, `Êö´ÁÑ°${taskType}‰ªªÂãôË®òÈåÑ`, false);
                }
            } catch (error) {
                log(`‚ùå ${taskType} ÁãÄÊÖãÊ™¢Êü•Â§±Êïó: ${error.message}`);
                showResult(resultElementId, `ÁãÄÊÖãÊ™¢Êü•Â§±Êïó: ${error.message}`, false);
            }
        }

        // Ê∏¨Ë©¶ÂõûË™øÁ´ØÈªû
        async function testCallbackEndpoint() {
            log('üîó Ê∏¨Ë©¶GenHumanÂõûË™øÁ´ØÈªû...');
            
            try {
                const response = await fetch(`${BASE_URL}/api/genhuman/callback/test`);
                const result = await response.json();
                
                if (result.success) {
                    showResult('callbackResult', `ÂõûË™øÁ´ØÈªûÊ∏¨Ë©¶ÊàêÂäüÔºÅ\nÁ´ØÈªûÈüøÊáâÊ≠£Â∏∏ÔºåÂèØ‰ª•Êé•Êî∂GenHumanÂõûË™ø`);
                    log(`‚úÖ ÂõûË™øÁ´ØÈªûÊ∏¨Ë©¶ÈÄöÈÅé`);
                } else {
                    throw new Error(result.error || 'ÂõûË™øÁ´ØÈªûÊ∏¨Ë©¶Â§±Êïó');
                }
            } catch (error) {
                log(`‚ùå ÂõûË™øÁ´ØÈªûÊ∏¨Ë©¶Â§±Êïó: ${error.message}`);
                showResult('callbackResult', `ÂõûË™øÁ´ØÈªûÊ∏¨Ë©¶Â§±Êïó: ${error.message}`, false);
            }
        }

        // Ê®°Êì¨ÂõûË™ø
        async function simulateCallback() {
            log('üé≠ Ê®°Êì¨GenHumanÂõûË™ø...');
            
            const mockCallback = {
                task_id: 'test_' + Date.now(),
                status: 'success',
                result_url: 'https://example.com/result.mp3',
                message: 'Ê®°Êì¨ÂõûË™øÊ∏¨Ë©¶'
            };
            
            try {
                const response = await fetch(`${BASE_URL}/api/genhuman/voice-clone/callback`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(mockCallback)
                });
                
                const result = await response.json();
                showResult('callbackResult', `Ê®°Êì¨ÂõûË™øÊ∏¨Ë©¶ÂÆåÊàêÔºÅ\nÂõûË™øÊï∏Êìö: ${JSON.stringify(mockCallback, null, 2)}\nÈüøÊáâ: ${JSON.stringify(result, null, 2)}`);
                log(`‚úÖ Ê®°Êì¨ÂõûË™øÊ∏¨Ë©¶ÂÆåÊàê`);
            } catch (error) {
                log(`‚ùå Ê®°Êì¨ÂõûË™øÂ§±Êïó: ${error.message}`);
                showResult('callbackResult', `Ê®°Êì¨ÂõûË™øÂ§±Êïó: ${error.message}`, false);
            }
        }

        // Â∞éÂá∫Ê∏¨Ë©¶ÁµêÊûú
        async function exportTestResults() {
            try {
                const response = await fetch(`${BASE_URL}/api/genhuman/export/results`);
                const result = await response.json();
                
                if (result.success) {
                    const dataStr = JSON.stringify(result.data, null, 2);
                    const blob = new Blob([dataStr], {type: 'application/json'});
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `genhuman_test_results_${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    log(`‚úÖ Ê∏¨Ë©¶ÁµêÊûúÂ∑≤Â∞éÂá∫`);
                    showResult('callbackResult', `Ê∏¨Ë©¶ÁµêÊûúÂ∞éÂá∫ÊàêÂäüÔºÅ\nÊñá‰ª∂Âêç: ${a.download}`);
                } else {
                    throw new Error(result.error || 'Â∞éÂá∫Â§±Êïó');
                }
            } catch (error) {
                log(`‚ùå Ê∏¨Ë©¶ÁµêÊûúÂ∞éÂá∫Â§±Êïó: ${error.message}`);
                showResult('callbackResult', `Ê∏¨Ë©¶ÁµêÊûúÂ∞éÂá∫Â§±Êïó: ${error.message}`, false);
            }
        }

        // ËºâÂÖ•Ê∏¨Ë©¶Ê≠∑Âè≤
        async function loadTestHistory() {
            try {
                const response = await fetch(`${BASE_URL}/api/genhuman/history`);
                const result = await response.json();
                
                if (result.success) {
                    log(`üìä ËºâÂÖ•GenHumanÊ∏¨Ë©¶Ê≠∑Âè≤: ${result.total_tasks} ÂÄãÊ≠∑Âè≤‰ªªÂãô`);
                    // Êõ¥Êñ∞Áµ±Ë®àÊï∏Êìö
                    if (result.stats) {
                        genhumanStats.completedTasks = result.stats.completed || 0;
                        genhumanStats.processingTasks = result.stats.processing || 0;
                        updateGenhumanStats('history_loaded');
                    }
                }
            } catch (error) {
                log(`‚ö†Ô∏è ÁÑ°Ê≥ïËºâÂÖ•GenHumanÊ∏¨Ë©¶Ê≠∑Âè≤: ${error.message}`);
            }
        }

        // Ê∏ÖÁ©∫GenHumanÊó•Ë™å
        function clearGenhumanLogs() {
            const logElements = ['voiceCloneLog', 'digitalHumanLog', 'ttsLog', 'videoGenerationLog', 'callbackLog', 'batchTestLog'];
            const resultElements = ['voiceCloneResult', 'digitalHumanResult', 'ttsResult', 'videoGenerationResult', 'callbackResult', 'batchTestResult'];
            
            [...logElements, ...resultElements].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = '';
                    element.className = element.id.includes('Log') ? 'result log' : 'result';
                }
            });
            
            log('üóëÔ∏è ÊâÄÊúâGenHumanÊó•Ë™åÂ∑≤Ê∏ÖÁ©∫');
        }

        // ÂÅúÊ≠¢ÊâÄÊúâÊ∏¨Ë©¶
        function stopAllTests() {
            stopCallbackMonitor();
            log('üõë ÊâÄÊúâGenHumanÊ∏¨Ë©¶Â∑≤ÂÅúÊ≠¢');
            showResult('batchTestResult', 'ÊâÄÊúâÊ∏¨Ë©¶Â∑≤ÂÅúÊ≠¢');
        }

        // ÂàóË°®ÂáΩÊï∏Ôºà‰Ωî‰ΩçÁ¨¶Ôºâ
        function listVoiceClones() { log('üìã ËÅ≤Èü≥ÂÖãÈöÜÊ≠∑Âè≤ÂäüËÉΩÈñãÁôº‰∏≠...'); }
        function listDigitalHumans() { log('üìã Êï∏Â≠ó‰∫∫Ê≠∑Âè≤ÂäüËÉΩÈñãÁôº‰∏≠...'); }
        function listTTSHistory() { log('üìã Ë™ûÈü≥ÂêàÊàêÊ≠∑Âè≤ÂäüËÉΩÈñãÁôº‰∏≠...'); }
        function listVideoHistory() { log('üìã Ë¶ñÈ†ªÁîüÊàêÊ≠∑Âè≤ÂäüËÉΩÈñãÁôº‰∏≠...'); }
    </script>
</body>
</html>

